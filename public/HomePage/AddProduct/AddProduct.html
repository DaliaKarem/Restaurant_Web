<!DOCTYPE html>
<html>
<head>
  <title>Add Product</title>
<link rel="stylesheet" href="./AddProduct/AddProduct.css">
<link rel="stylesheet" href="../../Shared/Shared.css">
</head>
<body>
    <nav class="nav">
        <div class="logo">
          <span class="stylish">Grand</span>
          <span class="logoRes">Resturant</span>
        </div>
        
        <div class="navigation">
          <div class="dropdown">
            <span>Name</span>
            <div class="dropdown-content">
            <ul>
              <li>
                <a href="Settings.html">Settings</a>
              </li>
              <li>
                <a href="Settings.html">Logout</a>
              </li>
            </ul>
            </div>
          </div>
        </div>
      </nav>
      <div class="drawer">
        <a href="/Home">My Products</a>
        <a class="active" href="/AddProduct">Add Product</a>
        <a href="#">Edit Product</a>
        <a href="#">Manage users</a>
      </div>

    
      <div class="container">
            <div class="detailsinfo">
              <h1>Add Product</h1>
              <form action="#">
                <label for="Category" style="float: left;padding-bottom: 20px;">Category :</label>
                <select name="Category" id="Category" style="float: left;margin-left: 20px;">
                  
                </select>
              </form>
              <label for="img">Select image:</label>
                <input type="file" id="img" name="img" accept="image/*">
              
                <div class="product-title"><input size="60%" placeholder="Product" id="name"></div>
            <div class="product-description"><input size="60%" id="desc" placeholder="ProductLorem ipsum dolor sit amet consectetur adipisicing elit. Adipisci rerum doloremque magni sunt nobis natus sed, ut reiciendis ullam ipsum laboriosam in, exercitationem nesciunt enim vitae ipsa soluta, aliquam tenetur">.</div>
            <div class="product-price"><input size="60%" id="price" placeholder="120" ></div>            
            <button id="submit"> Add </button>
          </div>
      </div>
    <script>
async function postData(url = "", data = {}) {
  // Default options are marked with *
  const response = await fetch(url, {
    method: "POST", 
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify(data),  
});
  let datas= await response.json(); 
  return datas;
}

let submitButton = document.getElementById("submit");
submitButton.addEventListener("click",async()=>{
    console.log("Starting...");
    let name = document.getElementById("name").value;
    let desc = document.getElementById("desc").value;
    let img=document.getElementById("img").value;
    let price=document.getElementById("price").value;
   // let email=JSON.parse(localStorage.getItem("user"))?.email;
    console.log("Submit button clicked",name,desc);
    let resp= await postData("/AddProduct",{name:name,desc:desc,price:price,img:img});
    
     if(resp.success) {
        alert("Success Addes This Product");
        document.getElementById("name").value="";
        document.getElementById("desc").value="";
        document.getElementById("price").value="";
        document.getElementById("img").value="";

        console.log("hhhhhhhhhhhhh");
     //console.log(JSON.parse(localStorage.getItem('user')));
        //fetchNotes();

     }
})
    
    //select category
    document.addEventListener('DOMContentLoaded', async () =>{
    // Sample categories (you can fetch these dynamically from your backend)
    
    const CategoryResponse = await postData("/getCategory");
    console.log("Category :"+CategoryResponse);
    //const categories = ['All Product','Category 2','Category 2', 'Category 2', 'Category 3', 'Category 4'];

    // Get the category list container
    const categoryList = document.getElementById('Category');

    // Add each category to the list
    CategoryResponse.categorys.forEach((category,i) => {
        const listItem = document.createElement('option');
        listItem.textContent = category.name;
        categoryList.appendChild(listItem);
    });
}); 
    
    </script>
</body>
</html>